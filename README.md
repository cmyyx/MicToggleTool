# MicToggleTool

<div align="center">

![Version](https://img.shields.io/github/v/release/cmyyx/MicToggleTool?label=version)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)
![License](https://img.shields.io/github/license/cmyyx/MicToggleTool)
![AutoHotkey](https://img.shields.io/badge/AutoHotkey-v2.0-red.svg)
![Size](https://img.shields.io/github/repo-size/cmyyx/MicToggleTool)
![Downloads](https://img.shields.io/github/downloads/cmyyx/MicToggleTool/total)
![Stars](https://img.shields.io/github/stars/cmyyx/MicToggleTool)
![Issues](https://img.shields.io/github/issues/cmyyx/MicToggleTool)

**ä¸€ä¸ªè½»é‡çº§çš„ Windows éº¦å…‹é£å¿«æ·æ§åˆ¶å·¥å…·**

[English](#english) | [ä¸­æ–‡](#ä¸­æ–‡)

[ä¸‹è½½](https://github.com/cmyyx/MicToggleTool/releases) â€¢ [æ–‡æ¡£](#ä¸­æ–‡) â€¢ [é—®é¢˜åé¦ˆ](https://github.com/cmyyx/MicToggleTool/issues)

</div>

---

## ä¸­æ–‡

### ğŸ“– ç®€ä»‹

MicToggleTool æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Windows ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨ç¨‹åºï¼Œå…è®¸æ‚¨é€šè¿‡å…¨å±€å¿«æ·é”®æˆ–æ‰˜ç›˜å›¾æ ‡å¿«é€Ÿåˆ‡æ¢éº¦å…‹é£çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€ï¼Œå¹¶åœ¨éº¦å…‹é£è¢«ç¦ç”¨æ—¶æ˜¾ç¤ºè§†è§‰æç¤ºã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ¯ **å…¨å±€å¿«æ·é”®æ§åˆ¶** - é»˜è®¤ F9ï¼Œå¯è‡ªå®šä¹‰ï¼Œåœ¨ä»»ä½•åº”ç”¨ä¸­éƒ½èƒ½å·¥ä½œ
- ğŸ–±ï¸ **ç³»ç»Ÿæ‰˜ç›˜é›†æˆ** - å·¦é”®ç‚¹å‡»åˆ‡æ¢ï¼Œå³é”®æ˜¾ç¤ºèœå•
- ğŸ’¬ **æ‚¬æµ®çª—æç¤º** - éº¦å…‹é£ç¦ç”¨æ—¶æ˜¾ç¤ºåŠé€æ˜æç¤ºçª—å£
- ğŸ¨ **åŠ¨æ€æ‰˜ç›˜å›¾æ ‡** - ç»¿è‰²ï¼ˆå¯ç”¨ï¼‰ã€çº¢è‰²ï¼ˆç¦ç”¨ï¼‰ã€ç°è‰²ï¼ˆä¸å¯ç”¨ï¼‰
- ğŸ”§ **çµæ´»é…ç½®** - INI é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒè‡ªå®šä¹‰å¿«æ·é”®ã€æ‚¬æµ®çª—æ ·å¼ç­‰
- ğŸš€ **å¼€æœºè‡ªå¯** - å¯é€‰çš„å¼€æœºè‡ªåŠ¨å¯åŠ¨åŠŸèƒ½
- ğŸ“¦ **å•æ–‡ä»¶ä¾¿æº** - æ‰€æœ‰èµ„æºåµŒå…¥ï¼Œæ— éœ€é¢å¤–æ–‡ä»¶
- ğŸ›¡ï¸ **ç®¡ç†å‘˜æƒé™** - ç¡®ä¿å¿«æ·é”®åœ¨æ‰€æœ‰åº”ç”¨ä¸­å·¥ä½œï¼ˆåŒ…æ‹¬æ¸¸æˆï¼‰

### ğŸ“¸ æˆªå›¾

> æ‰˜ç›˜å›¾æ ‡çŠ¶æ€ï¼š
> - ğŸŸ¢ ç»¿è‰² = éº¦å…‹é£å¯ç”¨
> - ğŸ”´ çº¢è‰² = éº¦å…‹é£ç¦ç”¨
> - âšª ç°è‰² = è®¾å¤‡ä¸å¯ç”¨

### ğŸš€ å¿«é€Ÿå¼€å§‹

#### ä¸‹è½½

ä» [Releases](https://github.com/cmyyx/MicToggleTool/releases) é¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ `MicToggleTool.exe`ã€‚

#### å®‰è£…

1. å°† `MicToggleTool.exe` æ”¾åˆ°ä»»æ„æ–‡ä»¶å¤¹
2. åŒå‡»è¿è¡Œ
3. åœ¨ UAC æç¤ºä¸­ç‚¹å‡»"æ˜¯"æˆäºˆç®¡ç†å‘˜æƒé™
4. é¦–æ¬¡è¿è¡Œæ—¶é€‰æ‹©è¦æ§åˆ¶çš„éº¦å…‹é£è®¾å¤‡

#### ä½¿ç”¨

- **å¿«æ·é”®**: æŒ‰ `F9` åˆ‡æ¢éº¦å…‹é£çŠ¶æ€ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
- **æ‰˜ç›˜å›¾æ ‡**: å·¦é”®ç‚¹å‡»åˆ‡æ¢ï¼Œå³é”®æ˜¾ç¤ºèœå•
- **æ‚¬æµ®çª—**: éº¦å…‹é£ç¦ç”¨æ—¶è‡ªåŠ¨æ˜¾ç¤ºæç¤º

### âš™ï¸ é…ç½®

é…ç½®æ–‡ä»¶ï¼š`MicToggleTool.ini`ï¼ˆé¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»ºï¼‰

#### ä¸»è¦é…ç½®é¡¹

```ini
[General]
Hotkey=F9                    ; å…¨å±€å¿«æ·é”®
AutoStart=0                  ; å¼€æœºè‡ªå¯ï¼ˆ0=ç¦ç”¨, 1=å¯ç”¨ï¼‰
TargetDevice=1               ; ç›®æ ‡éº¦å…‹é£è®¾å¤‡ ID
AdminCheck=prompt            ; ç®¡ç†å‘˜æƒé™æ£€æŸ¥æ¨¡å¼

[Overlay]
Enabled=1                    ; å¯ç”¨æ‚¬æµ®çª—ï¼ˆ0=ç¦ç”¨, 1=å¯ç”¨ï¼‰
Position=TopRight            ; ä½ç½®ï¼ˆTopLeft, TopRight, BottomLeft, BottomRight, TopCenter, BottomCenterï¼‰
OffsetX=100                  ; X è½´åç§»ï¼ˆåƒç´ ï¼‰
OffsetY=100                  ; Y è½´åç§»ï¼ˆåƒç´ ï¼‰
Transparency=200             ; é€æ˜åº¦ï¼ˆ0-255ï¼‰
BackgroundColor=F0F0F0       ; èƒŒæ™¯é¢œè‰²ï¼ˆRGB åå…­è¿›åˆ¶ï¼‰
TextColor=000000             ; æ–‡å­—é¢œè‰²ï¼ˆRGB åå…­è¿›åˆ¶ï¼‰
Text=éº¦å…‹é£å·²ç¦ç”¨            ; æç¤ºæ–‡æœ¬
FontSize=14                  ; å­—ä½“å¤§å°
ShowIcon=1                   ; æ˜¾ç¤ºå›¾æ ‡ï¼ˆ0=ä¸æ˜¾ç¤º, 1=æ˜¾ç¤ºï¼‰
```

#### å¿«æ·é”®æ ¼å¼

- `F9` - å•ä¸ªåŠŸèƒ½é”®
- `^F9` - Ctrl + F9
- `!F9` - Alt + F9
- `+F9` - Shift + F9
- `#F9` - Win + F9
- `^!M` - Ctrl + Alt + M

### ğŸ¯ é«˜çº§åŠŸèƒ½

#### è®¾å¤‡é€‰æ‹©

- æ”¯æŒæ˜¾ç¤ºè®¾å¤‡ IDï¼š`[18] Mic`
- å¯é€‰"æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡"æ¨¡å¼ï¼ŒåŒ…æ‹¬æ‰¬å£°å™¨
- æ”¯æŒè™šæ‹Ÿéº¦å…‹é£è®¾å¤‡ï¼ˆVoicemeeterã€VB-Audio ç­‰ï¼‰

#### è®¾å¤‡å¯ç”¨æ€§æ£€æµ‹

- è‡ªåŠ¨æ£€æµ‹è®¾å¤‡è¿æ¥çŠ¶æ€
- è®¾å¤‡æ–­å¼€æ—¶æ˜¾ç¤ºç°è‰²å›¾æ ‡
- è®¾å¤‡ ID å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°æŸ¥æ‰¾

#### æ—¥å¿—è®°å½•

- è‡ªåŠ¨è®°å½•è¿è¡Œæ—¥å¿—ï¼š`MicToggleTool.log`
- æ—¥å¿—è½®è½¬ï¼ˆè¶…è¿‡ 5MB è‡ªåŠ¨å¤‡ä»½ï¼‰
- å¯é€šè¿‡æ‰˜ç›˜èœå•æŸ¥çœ‹æ—¥å¿—

### ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Windows 7 / 8 / 8.1 / 10 / 11
- **æƒé™**: ç®¡ç†å‘˜æƒé™ï¼ˆæ¨èï¼‰
- **è®¾å¤‡**: è‡³å°‘ä¸€ä¸ªå¯ç”¨çš„éº¦å…‹é£è®¾å¤‡
- **ç£ç›˜ç©ºé—´**: < 5 MB

### ğŸ”§ æ•…éšœæ’é™¤

#### å¿«æ·é”®ä¸å·¥ä½œ

**é—®é¢˜**: æŒ‰å¿«æ·é”®æ²¡æœ‰ååº”

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ç¨‹åºä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œ
2. æ£€æŸ¥å¿«æ·é”®æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨
3. å°è¯•æ›´æ¢å…¶ä»–å¿«æ·é”®ï¼ˆç¼–è¾‘ `MicToggleTool.ini` ä¸­çš„ `Hotkey` å€¼ï¼‰
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ `MicToggleTool.log` äº†è§£è¯¦ç»†é”™è¯¯
5. åœ¨æŸäº›å…¨å±æ¸¸æˆä¸­ï¼Œå¯èƒ½éœ€è¦çª—å£åŒ–æˆ–æ— è¾¹æ¡†æ¨¡å¼

#### è®¾å¤‡ä¸å¯ç”¨

**é—®é¢˜**: æ‰˜ç›˜å›¾æ ‡æ˜¾ç¤ºç°è‰²ï¼Œæç¤ºè®¾å¤‡ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥éº¦å…‹é£æ˜¯å¦å·²è¿æ¥
2. æ‰“å¼€è®¾å¤‡ç®¡ç†å™¨ï¼Œç¡®è®¤è®¾å¤‡çŠ¶æ€æ­£å¸¸
3. å°è¯•é‡æ–°é€‰æ‹©è®¾å¤‡ï¼š
   - å³é”®æ‰˜ç›˜å›¾æ ‡ â†’ é€‰æ‹©è®¾å¤‡
   - å‹¾é€‰"æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡ï¼ˆåŒ…æ‹¬æ‰¬å£°å™¨ï¼‰"
   - é€‰æ‹©æ­£ç¡®çš„éº¦å…‹é£è®¾å¤‡
4. æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¢«å…¶ä»–ç¨‹åºç‹¬å 
5. é‡å¯ç¨‹åºæˆ–é‡æ–°æ’æ‹”è®¾å¤‡

#### UAC æç¤ºæœªæ˜¾ç¤º

**é—®é¢˜**: åŒå‡»ç¨‹åºæ²¡æœ‰ UAC æç¤º

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ Windows UAC è®¾ç½®ï¼ˆæ§åˆ¶é¢æ¿ â†’ ç”¨æˆ·è´¦æˆ· â†’ æ›´æ”¹ç”¨æˆ·è´¦æˆ·æ§åˆ¶è®¾ç½®ï¼‰
2. å³é”®ç¨‹åº â†’ ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
3. é‡æ–°ä¸‹è½½ç¨‹åºï¼ˆå¯èƒ½æ–‡ä»¶æŸåæˆ–è¢«æ€æ¯’è½¯ä»¶ä¿®æ”¹ï¼‰
4. æ£€æŸ¥æ–‡ä»¶å±æ€§ â†’ å…¼å®¹æ€§ â†’ æ˜¯å¦å‹¾é€‰äº†"ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œæ­¤ç¨‹åº"

#### é…ç½®æ–‡ä»¶æŸå

**é—®é¢˜**: ç¨‹åºå¯åŠ¨æ—¶æç¤ºé…ç½®æ–‡ä»¶é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. ç¨‹åºä¼šè‡ªåŠ¨å¤‡ä»½æŸåçš„é…ç½®æ–‡ä»¶ï¼ˆå¸¦æ—¶é—´æˆ³ï¼‰
2. åˆ é™¤ `MicToggleTool.ini`ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®
3. ä»å¤‡ä»½æ–‡ä»¶ä¸­æ¢å¤éœ€è¦çš„é…ç½®é¡¹

#### æ—¥å¿—æ–‡ä»¶è¿‡å¤§

**é—®é¢˜**: æ—¥å¿—æ–‡ä»¶å ç”¨ç©ºé—´è¿‡å¤§

**è§£å†³æ–¹æ¡ˆ**:
1. ç¨‹åºä¼šè‡ªåŠ¨è½®è½¬æ—¥å¿—ï¼ˆè¶…è¿‡ 5MB æ—¶å¤‡ä»½ï¼‰
2. æ‰‹åŠ¨åˆ é™¤æ—§çš„å¤‡ä»½æ—¥å¿—æ–‡ä»¶ï¼ˆ`MicToggleTool.log.backup_*`ï¼‰
3. é€šè¿‡æ‰˜ç›˜èœå• â†’ æŸ¥çœ‹æ—¥å¿—ï¼Œå¯ä»¥æ¸…ç†æ‰€æœ‰æ—¥å¿—

### â“ å¸¸è§é—®é¢˜ (FAQ)

#### Q: ä¸ºä»€ä¹ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼Ÿ

**A**: ç®¡ç†å‘˜æƒé™ç¡®ä¿å…¨å±€å¿«æ·é”®èƒ½åœ¨æ‰€æœ‰åº”ç”¨ç¨‹åºä¸­å·¥ä½œï¼ŒåŒ…æ‹¬ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œçš„ç¨‹åºï¼ˆå¦‚æŸäº›æ¸¸æˆã€ç³»ç»Ÿå·¥å…·ç­‰ï¼‰ã€‚å¦‚æœä¸ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼Œå¿«æ·é”®å¯èƒ½åœ¨è¿™äº›ç¨‹åºä¸­æ— æ³•å“åº”ã€‚

#### Q: ç¨‹åºä¼šæ”¶é›†æˆ‘çš„æ•°æ®å—ï¼Ÿ

**A**: ä¸ä¼šã€‚ç¨‹åºå®Œå…¨åœ¨æœ¬åœ°è¿è¡Œï¼Œä¸ä¼šè¿æ¥ç½‘ç»œï¼Œä¸ä¼šæ”¶é›†æˆ–ä¸Šä¼ ä»»ä½•æ•°æ®ã€‚æ‰€æœ‰é…ç½®å’Œæ—¥å¿—éƒ½ä¿å­˜åœ¨æœ¬åœ°ã€‚

#### Q: å¯ä»¥æ§åˆ¶å¤šä¸ªéº¦å…‹é£å—ï¼Ÿ

**A**: å½“å‰ç‰ˆæœ¬ä¸€æ¬¡åªèƒ½æ§åˆ¶ä¸€ä¸ªéº¦å…‹é£è®¾å¤‡ã€‚å¦‚æœéœ€è¦åˆ‡æ¢è®¾å¤‡ï¼Œå¯ä»¥é€šè¿‡æ‰˜ç›˜èœå• â†’ é€‰æ‹©è®¾å¤‡æ¥æ›´æ¢ã€‚

#### Q: æ”¯æŒ macOS æˆ– Linux å—ï¼Ÿ

**A**: ä¸æ”¯æŒã€‚æœ¬ç¨‹åºåŸºäº AutoHotkey v2 å¼€å‘ï¼Œä»…æ”¯æŒ Windows å¹³å°ã€‚

#### Q: å¯ä»¥è‡ªå®šä¹‰æ‰˜ç›˜å›¾æ ‡å—ï¼Ÿ

**A**: å½“å‰ç‰ˆæœ¬ä½¿ç”¨å†…ç½®å›¾æ ‡ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰ï¼Œå¯ä»¥ä¿®æ”¹æºä»£ç ä¸­çš„å›¾æ ‡èµ„æºå¹¶é‡æ–°ç¼–è¯‘ã€‚

#### Q: ç¨‹åºå ç”¨å¤šå°‘èµ„æºï¼Ÿ

**A**: éå¸¸è½»é‡ï¼š
- å†…å­˜å ç”¨: < 10 MB
- CPU å ç”¨: ç©ºé—²æ—¶ < 0.1%
- ç£ç›˜ç©ºé—´: < 5 MBï¼ˆåŒ…å«æ‰€æœ‰èµ„æºï¼‰

#### Q: å¦‚ä½•å¸è½½ï¼Ÿ

**A**: 
1. å³é”®æ‰˜ç›˜å›¾æ ‡ â†’ é€€å‡º
2. å¦‚æœå¯ç”¨äº†å¼€æœºè‡ªå¯ï¼Œå…ˆå–æ¶ˆå‹¾é€‰"å¼€æœºå¯åŠ¨"
3. åˆ é™¤ `MicToggleTool.exe` æ–‡ä»¶
4. ï¼ˆå¯é€‰ï¼‰åˆ é™¤é…ç½®æ–‡ä»¶ `MicToggleTool.ini` å’Œæ—¥å¿—æ–‡ä»¶ `MicToggleTool.log`
5. ï¼ˆå¯é€‰ï¼‰åˆ é™¤ä¸´æ—¶å›¾æ ‡æ–‡ä»¶å¤¹ `%TEMP%\MicToggleTool_Icons\`

#### Q: å¯ä»¥åœ¨å¤šå°ç”µè„‘ä¸Šä½¿ç”¨å—ï¼Ÿ

**A**: å¯ä»¥ã€‚ç¨‹åºæ˜¯å•æ–‡ä»¶ä¾¿æºç‰ˆï¼Œå¯ä»¥å¤åˆ¶åˆ° U ç›˜æˆ–å…¶ä»–ç”µè„‘ä½¿ç”¨ã€‚é…ç½®æ–‡ä»¶ä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºã€‚

#### Q: æ”¯æŒå“ªäº›å¿«æ·é”®ï¼Ÿ

**A**: æ”¯æŒæ‰€æœ‰ AutoHotkey v2 æ”¯æŒçš„å¿«æ·é”®æ ¼å¼ï¼ŒåŒ…æ‹¬ï¼š
- åŠŸèƒ½é”®ï¼šF1-F24
- å­—æ¯é”®ï¼šA-Z
- æ•°å­—é”®ï¼š0-9
- ä¿®é¥°ç¬¦ï¼šCtrl (^), Alt (!), Shift (+), Win (#)
- ç»„åˆé”®ï¼šå¦‚ ^!M (Ctrl+Alt+M)

è¯¦è§é…ç½®ç« èŠ‚çš„å¿«æ·é”®æ ¼å¼è¯´æ˜ã€‚

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

#### æ ¸å¿ƒæŠ€æœ¯

- **è¯­è¨€**: AutoHotkey v2.0
- **ç¼–è¯‘å™¨**: Ahk2Exe
- **èµ„æºåµŒå…¥**: FileInstall
- **æƒé™ç®¡ç†**: UAC Manifest

#### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           AppController                 â”‚  åº”ç”¨ä¸»æ§åˆ¶å™¨
â”‚  (åˆå§‹åŒ–ã€åè°ƒå„æ¨¡å—ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HotkeyListenerâ”‚ â”‚TrayManagerâ”‚ â”‚OverlayManager â”‚
â”‚  (å¿«æ·é”®ç›‘å¬) â”‚ â”‚ (æ‰˜ç›˜ç®¡ç†) â”‚ â”‚  (æ‚¬æµ®çª—ç®¡ç†)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚           â”‚           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ MicrophoneController  â”‚  éº¦å…‹é£æ§åˆ¶æ ¸å¿ƒ
        â”‚  (è®¾å¤‡æšä¸¾ã€çŠ¶æ€æ§åˆ¶)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ConfigManager â”‚ â”‚AdminCheckerâ”‚ â”‚ResourceManagerâ”‚
â”‚ (é…ç½®ç®¡ç†)   â”‚ â”‚ (æƒé™æ£€æŸ¥) â”‚ â”‚  (èµ„æºç®¡ç†)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å…³é”®ç‰¹æ€§å®ç°

**1. å•æ–‡ä»¶ä¾¿æº**
- ä½¿ç”¨ `FileInstall` åœ¨ç¼–è¯‘æ—¶åµŒå…¥å›¾æ ‡èµ„æº
- è¿è¡Œæ—¶æå–åˆ°ä¸´æ—¶ç›®å½• `%TEMP%\MicToggleTool_Icons\`
- é€€å‡ºæ—¶è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶

**2. å…¨å±€å¿«æ·é”®**
- ä½¿ç”¨ AutoHotkey çš„ `Hotkey` å‡½æ•°æ³¨å†Œ
- éœ€è¦ç®¡ç†å‘˜æƒé™ç¡®ä¿åœ¨æ‰€æœ‰åº”ç”¨ä¸­å·¥ä½œ
- æ”¯æŒåŠ¨æ€æ›´æ–°å¿«æ·é”®

**3. è®¾å¤‡ç®¡ç†**
- é€šè¿‡ `SoundGetName` å’Œ `SoundGetMute` æšä¸¾è®¾å¤‡
- æ”¯æŒè®¾å¤‡ ID å’Œåç§°åŒé‡è¯†åˆ«
- è‡ªåŠ¨å¤„ç†è®¾å¤‡ ID å˜åŒ–

**4. UAC æƒé™**
- é€šè¿‡ Manifest æ–‡ä»¶è¦æ±‚ç®¡ç†å‘˜æƒé™
- è¿è¡Œæ—¶æ£€æŸ¥æƒé™çŠ¶æ€
- æä¾›ææƒé‡å¯åŠŸèƒ½

**5. é…ç½®æŒä¹…åŒ–**
- INI æ ¼å¼é…ç½®æ–‡ä»¶
- è‡ªåŠ¨å¤‡ä»½æŸåçš„é…ç½®
- æ”¯æŒçƒ­é‡è½½ï¼ˆéƒ¨åˆ†é…ç½®ï¼‰

### ğŸ› ï¸ å¼€å‘æŒ‡å—

#### ç¯å¢ƒè¦æ±‚

- [AutoHotkey v2.0+](https://www.autohotkey.com/)
- Windows 7 æˆ–æ›´é«˜ç‰ˆæœ¬
- æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆæ¨è VS Code + AutoHotkey v2 æ‰©å±•ï¼‰

#### é¡¹ç›®ç»“æ„

```
MicToggleTool/
â”œâ”€â”€ MicToggleTool.ahk          # ä¸»è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ MicToggleTool.manifest     # UAC æ¸…å•æ–‡ä»¶
â”œâ”€â”€ icons/                     # å›¾æ ‡èµ„æº
â”‚   â”œâ”€â”€ mic_enabled.png        # å¯ç”¨å›¾æ ‡
â”‚   â”œâ”€â”€ mic_disabled.png       # ç¦ç”¨å›¾æ ‡
â”‚   â”œâ”€â”€ mic_unavailable.png    # ä¸å¯ç”¨å›¾æ ‡
â”‚   â”œâ”€â”€ mic_enabled.ico        # ç¨‹åºå›¾æ ‡
â”‚   â”œâ”€â”€ mic_disabled.ico
â”‚   â””â”€â”€ mic_unavailable.ico
â””â”€â”€ README.md                  # æœ¬æ–‡ä»¶
```

#### å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/cmyyx/MicToggleTool.git
cd MicToggleTool
```

#### è¿è¡Œå¼€å‘ç‰ˆæœ¬

ç›´æ¥è¿è¡Œè„šæœ¬ï¼ˆæ— éœ€ç¼–è¯‘ï¼‰ï¼š

```bash
# æ–¹æ³• 1: åŒå‡» MicToggleTool.ahk
# æ–¹æ³• 2: ä½¿ç”¨ AutoHotkey è¿è¡Œ
"C:\Program Files\AutoHotkey\AutoHotkey64.exe" MicToggleTool.ahk
```

#### ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶

##### æ–¹æ³• 1: ä½¿ç”¨ Ahk2Exe GUI

1. æ‰“å¼€ Ahk2Exe ç¼–è¯‘å™¨ï¼ˆé€šå¸¸åœ¨ `C:\Program Files\AutoHotkey\Compiler\Ahk2Exe.exe`ï¼‰
2. é…ç½®ï¼š
   - **Source**: `MicToggleTool.ahk`
   - **Destination**: `MicToggleTool.exe`
   - **Icon**: `icons\mic_enabled.ico`
   - **Base File**: `AutoHotkey64.exe`
3. ç‚¹å‡» **Convert** ç¼–è¯‘

##### æ–¹æ³• 2: å‘½ä»¤è¡Œç¼–è¯‘

```bash
"C:\Program Files\AutoHotkey\Compiler\Ahk2Exe.exe" /in "MicToggleTool.ahk" /out "MicToggleTool.exe" /icon "icons\mic_enabled.ico"
```

#### ç¼–è¯‘è¯´æ˜

- **UAC æ¸…å•**: é€šè¿‡è„šæœ¬ä¸­çš„ `@Ahk2Exe-AddResource` æŒ‡ä»¤è‡ªåŠ¨åµŒå…¥
- **å›¾æ ‡èµ„æº**: ä½¿ç”¨ `FileInstall` åœ¨ç¼–è¯‘æ—¶åµŒå…¥åˆ° exe ä¸­
- **å•æ–‡ä»¶**: æ‰€æœ‰èµ„æºï¼ˆå›¾æ ‡ã€æ¸…å•ï¼‰éƒ½åµŒå…¥åˆ° exeï¼Œæ— éœ€é¢å¤–æ–‡ä»¶

#### è°ƒè¯•

æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š
```bash
# æ—¥å¿—æ–‡ä»¶ä½ç½®
.\MicToggleTool.log

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆPowerShellï¼‰
Get-Content .\MicToggleTool.log -Wait -Tail 50
```

#### ä»£ç ç»“æ„

ä¸»è¦ç±»å’Œæ¨¡å—ï¼š

- **ResourceManager** - èµ„æºç®¡ç†ï¼ˆåµŒå…¥å›¾æ ‡æå–ï¼‰
- **ConfigManager** - é…ç½®æ–‡ä»¶ç®¡ç†
- **MicrophoneController** - éº¦å…‹é£æ§åˆ¶æ ¸å¿ƒ
- **DeviceSelector** - è®¾å¤‡é€‰æ‹©å¯¹è¯æ¡†
- **TrayManager** - ç³»ç»Ÿæ‰˜ç›˜ç®¡ç†
- **OverlayManager** - æ‚¬æµ®çª—ç®¡ç†
- **HotkeyListener** - å…¨å±€å¿«æ·é”®ç›‘å¬
- **AdminChecker** - ç®¡ç†å‘˜æƒé™æ£€æŸ¥
- **SettingsDialog** - è®¾ç½®å¯¹è¯æ¡†
- **AppController** - åº”ç”¨ç¨‹åºä¸»æ§åˆ¶å™¨

### ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

#### æŠ¥å‘Šé—®é¢˜

åœ¨ [Issues](https://github.com/cmyyx/MicToggleTool/issues) é¡µé¢æäº¤é—®é¢˜æ—¶ï¼Œè¯·åŒ…å«ï¼š

- æ“ä½œç³»ç»Ÿç‰ˆæœ¬
- ç¨‹åºç‰ˆæœ¬
- è¯¦ç»†çš„é—®é¢˜æè¿°
- å¤ç°æ­¥éª¤
- ç›¸å…³æ—¥å¿—ï¼ˆå¦‚æœæœ‰ï¼‰

#### æäº¤ä»£ç 

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

#### ä»£ç è§„èŒƒ

- ä½¿ç”¨ 4 ç©ºæ ¼ç¼©è¿›
- å‡½æ•°å’Œç±»ä½¿ç”¨ PascalCase
- å˜é‡ä½¿ç”¨ camelCase
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šï¼ˆä¸­æ–‡ï¼‰
- éµå¾ªç°æœ‰ä»£ç é£æ ¼

#### æäº¤ä¿¡æ¯è§„èŒƒ

```
<type>: <subject>

<body>
```

ç±»å‹ï¼ˆtypeï¼‰ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤ bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»º/å·¥å…·ç›¸å…³

ç¤ºä¾‹ï¼š
```
feat: æ·»åŠ è®¾å¤‡ ID æ˜¾ç¤ºåŠŸèƒ½

- åœ¨è®¾å¤‡åˆ—è¡¨ä¸­æ˜¾ç¤ºè®¾å¤‡ ID
- æ ¼å¼ï¼š[ID] è®¾å¤‡åç§°
- ä¾¿äºç”¨æˆ·è¯†åˆ«å’Œè°ƒè¯•
```

### ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

### ğŸ™ è‡´è°¢

- ä½¿ç”¨ [AutoHotkey v2](https://www.autohotkey.com/) å¼€å‘
- å›¾æ ‡èµ„æºåµŒå…¥æŠ€æœ¯

---

## English

### ğŸ“– Introduction

MicToggleTool is a lightweight Windows system tray application that allows you to quickly toggle your microphone on/off using a global hotkey or tray icon, with visual feedback when the microphone is disabled.

### âœ¨ Key Features

- ğŸ¯ **Global Hotkey Control** - Default F9, customizable, works in any application
- ğŸ–±ï¸ **System Tray Integration** - Left-click to toggle, right-click for menu
- ğŸ’¬ **Overlay Notification** - Semi-transparent overlay when microphone is disabled
- ğŸ¨ **Dynamic Tray Icon** - Green (enabled), Red (disabled), Gray (unavailable)
- ğŸ¤ **Multi-Device Support** - Supports both real and virtual microphone devices
- ğŸ”§ **Flexible Configuration** - INI config file, customize hotkey, overlay style, etc.
- ğŸš€ **Auto-Start** - Optional auto-start on Windows boot
- ğŸ“¦ **Single File Portable** - All resources embedded, no additional files needed
- ğŸ›¡ï¸ **Administrator Rights** - Ensures hotkey works in all applications (including games)

### ğŸš€ Quick Start

#### Download

Download the latest `MicToggleTool.exe` from the [Releases](https://github.com/cmyyx/MicToggleTool/releases) page.

#### Installation

1. Place `MicToggleTool.exe` in any folder
2. Double-click to run
3. Click "Yes" in the UAC prompt to grant administrator rights
4. Select your microphone device on first run

#### Usage

- **Hotkey**: Press `F9` to toggle microphone (customizable)
- **Tray Icon**: Left-click to toggle, right-click for menu
- **Overlay**: Automatically shows when microphone is disabled

### âš™ï¸ Configuration

Configuration file: `MicToggleTool.ini` (auto-created on first run)

See the Chinese section above for detailed configuration options.

### ğŸ“‹ System Requirements

- **OS**: Windows 7 / 8 / 8.1 / 10 / 11
- **Permissions**: Administrator rights (recommended)
- **Device**: At least one available microphone device
- **Disk Space**: < 5 MB

### ğŸ¤ Contributing

Issues and Pull Requests are welcome!

### ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

### ğŸ“§ Contact

- Issues: [Submit Issue](https://github.com/cmyyx/MicToggleTool/issues)

---

<div align="center">

Made with â¤ï¸ using AutoHotkey v2

â­ Star this repo if you find it useful!

</div>
